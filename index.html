<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #c27e65; -webkit-text-stroke: #c27e65}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #36c0a0; -webkit-text-stroke: #36c0a0}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #4689cc; -webkit-text-stroke: #4689cc}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #4f7b3d; -webkit-text-stroke: #4f7b3d}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca; min-height: 14.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #d4d4d4; -webkit-text-stroke: #d4d4d4}
    span.s1 {font-kerning: none; color: #4689cc; background-color: #181818; -webkit-text-stroke: 0px #4689cc}
    span.s2 {font-kerning: none; background-color: #181818}
    span.s3 {font-kerning: none; color: #36c0a0; background-color: #181818; -webkit-text-stroke: 0px #36c0a0}
    span.s4 {font-kerning: none; color: #d4d4d4; background-color: #181818; -webkit-text-stroke: 0px #d4d4d4}
    span.s5 {font-kerning: none; color: #c27e65; background-color: #181818; -webkit-text-stroke: 0px #c27e65}
    span.s6 {font-kerning: none; color: #cacaca; background-color: #181818; -webkit-text-stroke: 0px #cacaca}
    span.s7 {font-kerning: none}
    span.s8 {font-kerning: none; color: #a7c598; background-color: #181818; -webkit-text-stroke: 0px #a7c598}
    span.s9 {font-kerning: none; color: #4f7b3d; background-color: #181818; -webkit-text-stroke: 0px #4f7b3d}
  </style>
</head>
<body>
<p class="p1"><span class="s1">import</span><span class="s2"> </span><span class="s3">React</span><span class="s4">,</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> useRef</span><span class="s4">,</span><span class="s2"> useMemo</span><span class="s4">,</span><span class="s2"> useState </span><span class="s4">}</span><span class="s2"> </span><span class="s1">from</span><span class="s2"> </span><span class="s5">'react'</span><span class="s4">;</span></p>
<p class="p2"><span class="s1">import</span><span class="s6"> </span><span class="s4">{</span><span class="s6"> </span><span class="s3">Canvas</span><span class="s4">,</span><span class="s6"> useFrame </span><span class="s4">}</span><span class="s6"> </span><span class="s1">from</span><span class="s6"> </span><span class="s2">'@react-three/fiber'</span><span class="s4">;</span></p>
<p class="p3"><span class="s1">import</span><span class="s6"> </span><span class="s4">{</span><span class="s6"> </span><span class="s2">OrbitControls</span><span class="s4">,</span><span class="s6"> </span><span class="s2">PerspectiveCamera</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Environment</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Sparkles</span><span class="s6"> </span><span class="s4">}</span><span class="s6"> </span><span class="s1">from</span><span class="s6"> </span><span class="s5">'@react-three/drei'</span><span class="s4">;</span></p>
<p class="p3"><span class="s1">import</span><span class="s6"> </span><span class="s4">{</span><span class="s6"> </span><span class="s2">EffectComposer</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Bloom</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Vignette</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Noise</span><span class="s6"> </span><span class="s4">}</span><span class="s6"> </span><span class="s1">from</span><span class="s6"> </span><span class="s5">'@react-three/postprocessing'</span><span class="s4">;</span></p>
<p class="p4"><span class="s2">import</span><span class="s6"> </span><span class="s4">*</span><span class="s6"> </span><span class="s2">as</span><span class="s6"> </span><span class="s3">THREE</span><span class="s6"> </span><span class="s2">from</span><span class="s6"> </span><span class="s5">'three'</span><span class="s4">;</span></p>
<p class="p2"><span class="s1">import</span><span class="s6"> </span><span class="s4">{</span><span class="s6"> </span><span class="s3">Foliage</span><span class="s6"> </span><span class="s4">}</span><span class="s6"> </span><span class="s1">from</span><span class="s6"> </span><span class="s2">'./Foliage'</span><span class="s4">;</span></p>
<p class="p1"><span class="s1">import</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> </span><span class="s3">Ornaments</span><span class="s4">,</span><span class="s2"> generateOrnamentData </span><span class="s4">}</span><span class="s2"> </span><span class="s1">from</span><span class="s2"> </span><span class="s5">'./Ornaments'</span><span class="s4">;</span></p>
<p class="p2"><span class="s1">import</span><span class="s6"> </span><span class="s4">{</span><span class="s6"> </span><span class="s3">WrappingRibbon</span><span class="s6"> </span><span class="s4">}</span><span class="s6"> </span><span class="s1">from</span><span class="s6"> </span><span class="s2">'./WrappingRibbon'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1">import</span><span class="s6"> </span><span class="s4">{</span><span class="s6"> </span><span class="s3">Snow</span><span class="s6"> </span><span class="s4">}</span><span class="s6"> </span><span class="s1">from</span><span class="s6"> </span><span class="s5">'./Snow'</span><span class="s4">;</span><span class="s6"> </span><span class="s2">// Import Snow</span></p>
<p class="p4"><span class="s2">import</span><span class="s6"> </span><span class="s4">{</span><span class="s6"> </span><span class="s3">TreeState</span><span class="s6"> </span><span class="s4">}</span><span class="s6"> </span><span class="s2">from</span><span class="s6"> </span><span class="s5">'../types'</span><span class="s4">;</span></p>
<p class="p1"><span class="s1">import</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> easeInOutBack</span><span class="s4">,</span><span class="s2"> easeInOutCubic </span><span class="s4">}</span><span class="s2"> </span><span class="s1">from</span><span class="s2"> </span><span class="s5">'../utils/math'</span><span class="s4">;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p3"><span class="s1">interface</span><span class="s6"> </span><span class="s2">ExperienceProps</span><span class="s6"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span>treeState</span><span class="s4">:</span><span class="s2"> </span><span class="s3">TreeState</span><span class="s4">;</span></p>
<p class="p7"><span class="s2">}</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s2">// Component to handle smooth value transition for the scene</span></p>
<p class="p1"><span class="s1">const</span><span class="s2"> </span><span class="s3">SceneContent</span><span class="s4">:</span><span class="s2"> </span><span class="s3">React</span><span class="s4">.</span><span class="s3">FC</span><span class="s4">&lt;{</span><span class="s2"> targetState</span><span class="s4">:</span><span class="s2"> </span><span class="s3">TreeState</span><span class="s2"> </span><span class="s4">}&gt;</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> </span><span class="s4">({</span><span class="s2"> targetState </span><span class="s4">})</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> linearProgressRef </span><span class="s4">=</span><span class="s2"> useRef</span><span class="s4">(</span><span class="s8">1</span><span class="s4">);</span><span class="s2"> </span><span class="s9">// 0 (Scattered) to 1 (Tree)</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> easedProgressRef </span><span class="s4">=</span><span class="s2"> useRef</span><span class="s4">(</span><span class="s8">1</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> velocityRef </span><span class="s4">=</span><span class="s2"> useRef</span><span class="s4">(</span><span class="s8">0</span><span class="s4">);</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">  </span></span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">// Candy canes now have bows, so they are composite too</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> candyCaneData </span><span class="s4">=</span><span class="s2"> useMemo</span><span class="s4">(()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> generateOrnamentData</span><span class="s4">(</span><span class="s8">25</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'candyCane'</span><span class="s4">),</span><span class="s2"> </span><span class="s4">[]);</span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">// Gifts are now composite (Body + Ribbon)</span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">// Reduced count to 20 for fewer, smaller gifts</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> giftData </span><span class="s4">=</span><span class="s2"> useMemo</span><span class="s4">(()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> generateOrnamentData</span><span class="s4">(</span><span class="s8">20</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'gift'</span><span class="s4">),</span><span class="s2"> </span><span class="s4">[]);</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span>useFrame</span><span class="s4">((</span><span class="s2">state</span><span class="s4">,</span><span class="s2"> delta</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">// 1. Determine Target</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> target </span><span class="s4">=</span><span class="s2"> targetState </span><span class="s4">===</span><span class="s2"> </span><span class="s3">TreeState</span><span class="s4">.</span><span class="s3">TREE_SHAPE</span><span class="s2"> </span><span class="s4">?</span><span class="s2"> </span><span class="s8">1</span><span class="s2"> </span><span class="s4">:</span><span class="s2"> </span><span class="s8">0</span><span class="s4">;</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">// 2. Choose Smoothing Parameters based on Direction</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> isAssembling </span><span class="s4">=</span><span class="s2"> target </span><span class="s4">===</span><span class="s2"> </span><span class="s8">1</span><span class="s4">;</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">// Damping speed: Higher = Faster</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> speed </span><span class="s4">=</span><span class="s2"> isAssembling </span><span class="s4">?</span><span class="s2"> </span><span class="s8">1.0</span><span class="s2"> </span><span class="s4">:</span><span class="s2"> </span><span class="s8">3.0</span><span class="s4">;</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">// 3. Update Linear Progress</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>linearProgressRef</span><span class="s4">.</span><span class="s2">current </span><span class="s4">=</span><span class="s2"> </span><span class="s3">THREE</span><span class="s4">.</span><span class="s3">MathUtils</span><span class="s4">.</span><span class="s2">damp</span><span class="s4">(</span><span class="s2">linearProgressRef</span><span class="s4">.</span><span class="s2">current</span><span class="s4">,</span><span class="s2"> target</span><span class="s4">,</span><span class="s2"> speed</span><span class="s4">,</span><span class="s2"> delta</span><span class="s4">);</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">// 4. Calculate Eased Progress based on Phase</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">let</span><span class="s2"> nextEased </span><span class="s4">=</span><span class="s2"> </span><span class="s8">0</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">isAssembling</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>nextEased </span><span class="s4">=</span><span class="s2"> easeInOutCubic</span><span class="s4">(</span><span class="s2">linearProgressRef</span><span class="s4">.</span><span class="s2">current</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span><span class="s2"> </span><span class="s1">else</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>nextEased </span><span class="s4">=</span><span class="s2"> easeInOutBack</span><span class="s4">(</span><span class="s2">linearProgressRef</span><span class="s4">.</span><span class="s2">current</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">// 5. Calculate Velocity (for rotation physics)</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> dist </span><span class="s4">=</span><span class="s2"> </span><span class="s3">Math</span><span class="s4">.</span><span class="s2">abs</span><span class="s4">(</span><span class="s2">nextEased </span><span class="s4">-</span><span class="s2"> easedProgressRef</span><span class="s4">.</span><span class="s2">current</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>velocityRef</span><span class="s4">.</span><span class="s2">current </span><span class="s4">=</span><span class="s2"> dist </span><span class="s4">/</span><span class="s2"> delta</span><span class="s4">;</span><span class="s2"> </span><span class="s9">// Unit per second</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>easedProgressRef</span><span class="s4">.</span><span class="s2">current </span><span class="s4">=</span><span class="s2"> nextEased</span><span class="s4">;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">});</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p4"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">return</span><span class="s6"> </span><span class="s4">(</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">&lt;</span><span class="s2">group</span><span class="s4">&gt;</span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">{</span><span class="s2">/* Dynamic Lighting */</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s2">ambientLight intensity</span><span class="s4">={</span><span class="s8">0.2</span><span class="s4">}</span><span class="s2"> color</span><span class="s4">=</span><span class="s5">"#001a14"</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s2">spotLight<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>position</span><span class="s4">={[</span><span class="s8">10</span><span class="s4">,</span><span class="s2"> </span><span class="s8">20</span><span class="s4">,</span><span class="s2"> </span><span class="s8">10</span><span class="s4">]}</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>angle</span><span class="s4">={</span><span class="s8">0.3</span><span class="s4">}</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>penumbra</span><span class="s4">={</span><span class="s8">1</span><span class="s4">}</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>intensity</span><span class="s4">={</span><span class="s8">2</span><span class="s4">}</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>color</span><span class="s4">=</span><span class="s5">"#fffaed"</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>castShadow<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>/&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s2">pointLight position</span><span class="s4">={[-</span><span class="s8">10</span><span class="s4">,</span><span class="s2"> </span><span class="s4">-</span><span class="s8">5</span><span class="s4">,</span><span class="s2"> </span><span class="s4">-</span><span class="s8">10</span><span class="s4">]}</span><span class="s2"> intensity</span><span class="s4">={</span><span class="s8">1</span><span class="s4">}</span><span class="s2"> color</span><span class="s4">=</span><span class="s5">"#d4af37"</span><span class="s2"> /&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">{</span><span class="s2">/* 1. Foliage */</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">Foliage</span><span class="s2"> count</span><span class="s4">={</span><span class="s8">12000</span><span class="s4">}</span><span class="s2"> easedProgress</span><span class="s4">={</span><span class="s2">easedProgressRef</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">{</span><span class="s2">/* 2. Standard Ornaments */</span><span class="s4">}</span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">{</span><span class="s2">/* Red, Gold, Silver Baubles */</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">Ornaments</span><span class="s2"> count</span><span class="s4">={</span><span class="s8">90</span><span class="s4">}</span><span class="s2"> </span><span class="s1">type</span><span class="s4">=</span><span class="s5">"bauble"</span><span class="s2"> easedProgress</span><span class="s4">={</span><span class="s2">easedProgressRef</span><span class="s4">}</span><span class="s2"> velocityRef</span><span class="s4">={</span><span class="s2">velocityRef</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">{</span><span class="s2">/* Shiny Metallic Blue Baubles */</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">Ornaments</span><span class="s2"> count</span><span class="s4">={</span><span class="s8">30</span><span class="s4">}</span><span class="s2"> </span><span class="s1">type</span><span class="s4">=</span><span class="s5">"baubleBlue"</span><span class="s2"> easedProgress</span><span class="s4">={</span><span class="s2">easedProgressRef</span><span class="s4">}</span><span class="s2"> velocityRef</span><span class="s4">={</span><span class="s2">velocityRef</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">      </span></span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">{</span><span class="s2">/* Gifts: Split into Body and Decoration for multi-material effect */</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">Ornaments</span><span class="s2"> </span><span class="s1">type</span><span class="s4">=</span><span class="s5">"gift"</span><span class="s2"> variant</span><span class="s4">=</span><span class="s5">"body"</span><span class="s2"> data</span><span class="s4">={</span><span class="s2">giftData</span><span class="s4">}</span><span class="s2"> easedProgress</span><span class="s4">={</span><span class="s2">easedProgressRef</span><span class="s4">}</span><span class="s2"> velocityRef</span><span class="s4">={</span><span class="s2">velocityRef</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">Ornaments</span><span class="s2"> </span><span class="s1">type</span><span class="s4">=</span><span class="s5">"gift"</span><span class="s2"> variant</span><span class="s4">=</span><span class="s5">"decoration"</span><span class="s2"> data</span><span class="s4">={</span><span class="s2">giftData</span><span class="s4">}</span><span class="s2"> easedProgress</span><span class="s4">={</span><span class="s2">easedProgressRef</span><span class="s4">}</span><span class="s2"> velocityRef</span><span class="s4">={</span><span class="s2">velocityRef</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">      </span></span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">{</span><span class="s2">/* 3. Composite Ornaments (Layers) */</span><span class="s4">}</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">{</span><span class="s2">/* Candy Canes: Body + Decoration (Bow) */</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">Ornaments</span><span class="s2"> </span><span class="s1">type</span><span class="s4">=</span><span class="s5">"candyCane"</span><span class="s2"> variant</span><span class="s4">=</span><span class="s5">"body"</span><span class="s2"> data</span><span class="s4">={</span><span class="s2">candyCaneData</span><span class="s4">}</span><span class="s2"> easedProgress</span><span class="s4">={</span><span class="s2">easedProgressRef</span><span class="s4">}</span><span class="s2"> velocityRef</span><span class="s4">={</span><span class="s2">velocityRef</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">Ornaments</span><span class="s2"> </span><span class="s1">type</span><span class="s4">=</span><span class="s5">"candyCane"</span><span class="s2"> variant</span><span class="s4">=</span><span class="s5">"decoration"</span><span class="s2"> data</span><span class="s4">={</span><span class="s2">candyCaneData</span><span class="s4">}</span><span class="s2"> easedProgress</span><span class="s4">={</span><span class="s2">easedProgressRef</span><span class="s4">}</span><span class="s2"> velocityRef</span><span class="s4">={</span><span class="s2">velocityRef</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">      </span></span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">{</span><span class="s2">/* Scattered Flowy Ribbons (Bows) - Reduced count to 20 */</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">Ornaments</span><span class="s2"> count</span><span class="s4">={</span><span class="s8">20</span><span class="s4">}</span><span class="s2"> </span><span class="s1">type</span><span class="s4">=</span><span class="s5">"ribbon"</span><span class="s2"> easedProgress</span><span class="s4">={</span><span class="s2">easedProgressRef</span><span class="s4">}</span><span class="s2"> velocityRef</span><span class="s4">={</span><span class="s2">velocityRef</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">      </span></span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">{</span><span class="s2">/* 4. Single Wrapping Ribbon */</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">WrappingRibbon</span><span class="s2"> easedProgress</span><span class="s4">={</span><span class="s2">easedProgressRef</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">{</span><span class="s2">/* 5. Lights &amp; Top Star */</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">Ornaments</span><span class="s2"> count</span><span class="s4">={</span><span class="s8">300</span><span class="s4">}</span><span class="s2"> </span><span class="s1">type</span><span class="s4">=</span><span class="s5">"light"</span><span class="s2"> easedProgress</span><span class="s4">={</span><span class="s2">easedProgressRef</span><span class="s4">}</span><span class="s2"> velocityRef</span><span class="s4">={</span><span class="s2">velocityRef</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">Ornaments</span><span class="s2"> count</span><span class="s4">={</span><span class="s8">1</span><span class="s4">}</span><span class="s2"> </span><span class="s1">type</span><span class="s4">=</span><span class="s5">"star"</span><span class="s2"> easedProgress</span><span class="s4">={</span><span class="s2">easedProgressRef</span><span class="s4">}</span><span class="s2"> velocityRef</span><span class="s4">={</span><span class="s2">velocityRef</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">{</span><span class="s2">/* Ambient Floating Dust &amp; Snow */</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">Sparkles</span><span class="s2"> count</span><span class="s4">={</span><span class="s8">500</span><span class="s4">}</span><span class="s2"> scale</span><span class="s4">={</span><span class="s8">30</span><span class="s4">}</span><span class="s2"> size</span><span class="s4">={</span><span class="s8">4</span><span class="s4">}</span><span class="s2"> speed</span><span class="s4">={</span><span class="s8">0.4</span><span class="s4">}</span><span class="s2"> opacity</span><span class="s4">={</span><span class="s8">0.5</span><span class="s4">}</span><span class="s2"> color</span><span class="s4">=</span><span class="s5">"#ffd700"</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">Snow</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">&lt;/</span><span class="s2">group</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">);</span></p>
<p class="p7"><span class="s2">};</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p3"><span class="s1">export</span><span class="s6"> </span><span class="s1">const</span><span class="s6"> </span><span class="s2">Experience</span><span class="s4">:</span><span class="s6"> </span><span class="s2">React</span><span class="s4">.</span><span class="s2">FC</span><span class="s4">&lt;</span><span class="s2">ExperienceProps</span><span class="s4">&gt;</span><span class="s6"> </span><span class="s4">=</span><span class="s6"> </span><span class="s4">({</span><span class="s6"> treeState </span><span class="s4">})</span><span class="s6"> </span><span class="s4">=&gt;</span><span class="s6"> </span><span class="s4">{</span></p>
<p class="p4"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">return</span><span class="s6"> </span><span class="s4">(</span></p>
<p class="p3"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s4">&lt;</span><span class="s2">Canvas</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>dpr</span><span class="s4">={[</span><span class="s8">1</span><span class="s4">,</span><span class="s2"> </span><span class="s8">2</span><span class="s4">]}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>gl</span><span class="s4">={{</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>antialias</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s6"><span class="Apple-converted-space">        </span>toneMapping</span><span class="s4">:</span><span class="s6"> </span><span class="s2">THREE</span><span class="s4">.</span><span class="s2">ReinhardToneMapping</span><span class="s4">,</span><span class="s6"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>toneMappingExposure</span><span class="s4">:</span><span class="s2"> </span><span class="s8">1.5</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>alpha</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">}}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s2">color attach</span><span class="s4">=</span><span class="s5">"background"</span><span class="s2"> args</span><span class="s4">={[</span><span class="s5">'#000504'</span><span class="s4">]}</span><span class="s2"> /&gt;</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">      </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">PerspectiveCamera</span><span class="s2"> makeDefault position</span><span class="s4">={[</span><span class="s8">0</span><span class="s4">,</span><span class="s2"> </span><span class="s8">0</span><span class="s4">,</span><span class="s2"> </span><span class="s8">35</span><span class="s4">]}</span><span class="s2"> fov</span><span class="s4">={</span><span class="s8">45</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">      </span></span></p>
<p class="p3"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s2">OrbitControls</span><span class="s6"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>enablePan</span><span class="s4">={</span><span class="s1">false</span><span class="s4">}</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>maxPolarAngle</span><span class="s4">={</span><span class="s3">Math</span><span class="s4">.</span><span class="s3">PI</span><span class="s2"> </span><span class="s4">/</span><span class="s2"> </span><span class="s8">1.8</span><span class="s4">}</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>minPolarAngle</span><span class="s4">={</span><span class="s3">Math</span><span class="s4">.</span><span class="s3">PI</span><span class="s2"> </span><span class="s4">/</span><span class="s2"> </span><span class="s8">3</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>maxDistance</span><span class="s4">={</span><span class="s8">50</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>minDistance</span><span class="s4">={</span><span class="s8">10</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>autoRotate</span><span class="s4">={</span><span class="s2">treeState </span><span class="s4">===</span><span class="s2"> </span><span class="s3">TreeState</span><span class="s4">.</span><span class="s3">TREE_SHAPE</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>autoRotateSpeed</span><span class="s4">={</span><span class="s8">0.5</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>/&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">Environment</span><span class="s2"> preset</span><span class="s4">=</span><span class="s5">"city"</span><span class="s2"> /&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">SceneContent</span><span class="s2"> targetState</span><span class="s4">={</span><span class="s2">treeState</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s3">EffectComposer</span><span class="s2"> disableNormalPass</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">&lt;</span><span class="s3">Bloom</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span>luminanceThreshold</span><span class="s4">={</span><span class="s8">0.8</span><span class="s4">}</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span>mipmapBlur<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span>intensity</span><span class="s4">={</span><span class="s8">1.5</span><span class="s4">}</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span>radius</span><span class="s4">={</span><span class="s8">0.4</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>/&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">&lt;</span><span class="s3">Vignette</span><span class="s2"> eskil</span><span class="s4">={</span><span class="s1">false</span><span class="s4">}</span><span class="s2"> offset</span><span class="s4">={</span><span class="s8">0.1</span><span class="s4">}</span><span class="s2"> darkness</span><span class="s4">={</span><span class="s8">1.1</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">&lt;</span><span class="s3">Noise</span><span class="s2"> opacity</span><span class="s4">={</span><span class="s8">0.02</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p3"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;/</span><span class="s2">EffectComposer</span><span class="s4">&gt;</span></p>
<p class="p3"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s4">&lt;/</span><span class="s2">Canvas</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">);</span></p>
<p class="p7"><span class="s2">};</span></p>
</body>
</html>
